(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([[50],{f19f:function(t,e,o){"use strict";o.r(e);var s=function(){var t=this,e=t.$createElement,o=t._self._c||e;return t.loaded?o("div",{staticClass:"row justify-center"},[o("div",{staticClass:"row justify-between",staticStyle:{width:"1600px","margin-top":"30px"}},[o("div",{staticClass:"text-black text-h4",staticStyle:{width:"1000px"}},[t._v("\n          "+t._s(t.index)+" "),o("span",{staticClass:"text-red"},[t._v(" "+t._s(t.title)+" ")])]),o("div",{staticClass:"row justify-between q-mt-md",staticStyle:{width:"100%"}},[o("div",{staticStyle:{width:"1250px"}},[o("q-card",{staticClass:"q-pa-md ",attrs:{flat:""}},[0==t.total?o("div",[o("div",{staticClass:"text-center"},[o("q-img",{staticStyle:{width:"400px",height:"500px"},attrs:{src:"https://www.helloimg.com/images/2020/07/27/no_solution3604bbb1a4f6a3a7.jpg"}})],1),o("div",{staticClass:"text-center text-h4 text-black"},[t._v("\n                  暂无题解\n                ")])]):o("div",[o("div",{staticClass:"text-h5 text-black"},[t._v("\n                  总共 "+t._s(t.total)+" 份题解\n                ")]),t._l(t.solution_list,(function(e,s){return o("div",{key:s},[o("q-separator",{staticClass:"q-my-md"}),o("q-item",[o("q-item-section",{attrs:{top:"",avatar:""}},[o("q-avatar",{attrs:{size:"50px"}},[o("img",{attrs:{src:e.avatar}})])],1),o("q-item-section",[o("q-item-label",[o("span",{staticClass:"text-black",staticStyle:{"font-size":"20px"}},[t._v(" "+t._s(e.author)+" ")])]),o("q-item-label",{attrs:{caption:""}},[t._v("\n                        发表时间 "),o("Time",{staticClass:"q-ml-sm",attrs:{time:new Date(e.created_at).getTime()}})],1)],1),o("q-item-section",{staticClass:"col-2"},[o("q-item-label",t._l(e.tags,(function(e,s){return o("Tag",{key:s,attrs:{color:e.color}},[t._v(" "+t._s(e.label)+" ")])})),1)],1),o("q-item-section",{staticClass:"col-5"},[e.updated_at?o("q-item-label",{staticClass:"text-orange"},[t._v(" 修改于 "),o("Time",{staticClass:"q-ml-sm",attrs:{time:new Date(e.updated_at).getTime()}})],1):t._e()],1),o("q-item-section",{staticClass:" col-2"},[o("div",{staticStyle:{"text-align":"right"}},[o("Button",{attrs:{type:"text"},on:{click:function(o){return t.showCommentModal(e)}}},[o("Icon",{attrs:{type:"ios-chatbubbles-outline",size:"18"}}),e.reply_count>0?o("span",{staticStyle:{"font-size":"15px"}},[t._v(" "+t._s(e.reply_count)+" 条评论 ")]):o("span",{staticStyle:{"font-size":"15px"}},[t._v(" 添加评论 ")])],1)],1)])],1),o("q-card",{staticClass:"q-pa-md",attrs:{flat:"",bordered:""}},[o("div",{staticClass:"text-black",staticStyle:{"font-size":"20px"},domProps:{innerHTML:t._s(e.content_html)}})]),o("div",{staticClass:"q-px-sm q-mt-md"},[o("span",[o("q-btn",{attrs:{flat:"",color:e.good_color,icon:"thumb_up",dense:""},on:{click:function(o){return t.for_good_post(e)}}}),t._v(" "+t._s(e.good_count)+" ")],1),o("span",{staticClass:"q-ml-md"},[o("q-btn",{attrs:{flat:"",color:e.bad_color,icon:"thumb_down",dense:""},on:{click:function(o){return t.for_bad_post(e)}}}),t._v(" "+t._s(e.bad_count)+" ")],1)])],1)})),o("Page",{staticClass:"float-right",staticStyle:{"margin-top":"30px"},attrs:{current:t.current,total:t.total,"page-size":t.page_size},on:{"update:current":function(e){t.current=e},"on-change":t.get_solutions}})],2)])],1),o("div",{staticStyle:{width:"300px"}},[o("q-card",{staticClass:"q-pa-md",attrs:{flat:""}},[o("div",{staticClass:"row justify-between"},[o("Button",{attrs:{type:"primary",size:"large"},on:{click:t.showNewSolutionModal}},[t._v(" 发表题解 ")]),o("Button",{attrs:{type:"error",size:"large"},on:{click:function(e){return t.$router.push({name:"problem",params:{index:t.index}})}}},[t._v(" 返回题目 ")])],1)]),o("q-card",{staticClass:"q-pa-md q-mt-lg",attrs:{flat:""}},[o("div",{staticClass:"text-h6 text-black"},[t._v("\n                只作参考，不要作弊\n              ")])])],1)])]),o("Modal",{attrs:{width:"1200px",closable:!1,"mask-closable":!1},model:{value:t.newSolutionModal,callback:function(e){t.newSolutionModal=e},expression:"newSolutionModal"}},[o("div",{staticClass:"text-h6",attrs:{slot:"header"},slot:"header"},[t._v("\n        发表题解\n    ")]),o("div",{staticClass:"text-black q-mt-md text-h6"},[o("div",{staticClass:"q-mt-md"},[o("Tags",{ref:"tags",attrs:{prop_tags:t.prop_tags}})],1),o("q-separator",{staticClass:"q-mt-md"}),o("div",{staticClass:"q-mt-md"},[o("mavon-editor",{ref:"editor",attrs:{defaultOpen:"edit"},on:{imgAdd:t.imgAdd},model:{value:t.value,callback:function(e){t.value=e},expression:"value"}})],1)],1),o("div",{attrs:{slot:"footer"},slot:"footer"},[o("Button",{attrs:{type:"text"},on:{click:function(e){t.newSolutionModal=!1}}},[t._v(" 取消 ")]),o("Button",{attrs:{type:"primary"},on:{click:t.submit}},[t._v(" 提交 ")])],1)]),o("Modal",{attrs:{mask:!0,width:"800px"},model:{value:t.forComment,callback:function(e){t.forComment=e},expression:"forComment"}},[o("div",{staticClass:"text-teal",staticStyle:{"font-size":"20px"},attrs:{slot:"header"},slot:"header"},[o("q-icon",{attrs:{name:"send"}}),o("span",{staticClass:"q-ml-md"},[t._v(t._s(t.choose_post.author)+" ")])],1),o("div",[t.comments.length>0?o("q-scroll-area",{staticStyle:{height:"400px"}},t._l(t.comments,(function(e,s){return o("div",{key:s,staticClass:"row"},[0!=s?o("q-separator",{staticClass:"q-my-lg",attrs:{inset:""}}):t._e(),o("div",{staticStyle:{width:"60px"}},[o("div",[o("q-avatar",{attrs:{size:"50px"}},[o("img",{attrs:{src:e.avatar}})])],1)]),o("div",{staticStyle:{width:"700px"}},[o("div",{staticStyle:{"font-size":"18px"}},[o("span",{staticClass:"text-black"},[t._v(" "+t._s(e.author)),e.author==t.choose_post.author?o("span",{staticStyle:{color:"orange"}},[t._v(" (作者) ")]):t._e()]),""!=e.to?o("span",{staticClass:"q-ml-md"},[o("q-icon",{attrs:{name:"send"}}),t._v(" "+t._s(e.to)),e.to==t.choose_post.author?o("span",{staticStyle:{color:"orange"}},[t._v(" (作者) ")]):t._e()],1):t._e(),o("Time",{staticClass:"q-ml-lg",attrs:{time:new Date(e.created_at).getTime()}}),o("Button",{attrs:{type:"text"},on:{click:function(o){t.commentTo=e.author}}},[t._v(" 回复")]),o("div",{staticStyle:{"word-break":"break-all",color:"black","margin-top":"10px"},domProps:{innerHTML:t._s(e.content)}})],1)])],1)})),0):t._e(),0==t.comments.length?o("div",[t._v("\n          暂无评论\n        ")]):t._e()],1),o("div",{staticStyle:{"text-align":"left"},attrs:{slot:"footer"},slot:"footer"},[""!=t.commentTo?o("div",{staticClass:"text-red",staticStyle:{"font-size":"16px"}},[o("Tag",{attrs:{type:"border",closable:"",color:"magenta"},on:{"on-close":function(e){t.commentTo=""}}},[t._v(" @"+t._s(t.commentTo))])],1):t._e(),o("q-editor",{attrs:{"min-height":"4rem"},model:{value:t.text,callback:function(e){t.text=e},expression:"text"}}),o("Button",{staticClass:"q-mt-md",attrs:{type:"primary"},on:{click:t.send_one_comment}},[t._v(" 发表评论 ")])],1)])],1):t._e()},a=[],n=(o("ac6a"),o("ac4d"),o("8a81"),o("5df3"),o("1c4c"),o("7f7f"),o("6b54"),o("06db"),o("3855"));function i(t,e){var o;if("undefined"===typeof Symbol||null==t[Symbol.iterator]){if(Array.isArray(t)||(o=r(t))||e&&t&&"number"===typeof t.length){o&&(t=o);var s=0,a=function(){};return{s:a,n:function(){return s>=t.length?{done:!0}:{done:!1,value:t[s++]}},e:function(t){throw t},f:a}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var n,i=!0,l=!1;return{s:function(){o=t[Symbol.iterator]()},n:function(){var t=o.next();return i=t.done,t},e:function(t){l=!0,n=t},f:function(){try{i||null==o.return||o.return()}finally{if(l)throw n}}}}function r(t,e){if(t){if("string"===typeof t)return l(t,e);var o=Object.prototype.toString.call(t).slice(8,-1);return"Object"===o&&t.constructor&&(o=t.constructor.name),"Map"===o||"Set"===o?Array.from(t):"Arguments"===o||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(o)?l(t,e):void 0}}function l(t,e){(null==e||e>t.length)&&(e=t.length);for(var o=0,s=new Array(e);o<e;o++)s[o]=t[o];return s}var c={name:"solutionIndex",components:{Tags:n["a"]},data:function(){return{solution_list:[{avatar:"1.jpeg",author:"",created_at:"",updated_at:"",content_html:"",reply_count:2,good_count:0,bad_count:0}],loaded:!1,total:0,page_size:10,current:1,index:"",title:"",newSolutionModal:!1,prop_tags:[],value:"",forComment:!1,choose_post:{author:""},commentTo:"",text:"",comments:[]}},methods:{for_good_post:function(t){var e=1;1==t.for_post&&(e=0),this.$req.get("addPostAttitude",{post_id:t.post_id,attitude:e}).then((function(o){void 0==o.errno&&(t.for_post=e,t.good_color=0==e?"":"blue",t.bad_color="",t.good_count=o.good_count,t.bad_count=o.bad_count)}))},for_bad_post:function(t){var e=2;2==t.for_post&&(e=0),this.$req.get("addPostAttitude",{post_id:t.post_id,attitude:e}).then((function(o){void 0==o.errno&&(t.for_post=e,t.good_color="",t.bad_color=0==e?"":"blue",t.good_count=o.good_count,t.bad_count=o.bad_count)}))},showCommentModal:function(t){var e=this;this.choose_post=t,this.comments=[],this.commentTo="",t.reply_count>0?this.$req.get("getComments",{post_id:t.post_id,reply_id:0}).then((function(t){void 0==t.errno&&(e.comments=t.comments,e.forComment=!0)})):this.forComment=!0},send_one_comment:function(){var t=this;if(this.$store.state.user.is_login){var e=this.text.trim();if(e.length<=0)this.$notify("error","内容不能为空");else{var o=new FormData;o.set("content",e),o.set("post_id",this.choose_post.post_id),o.set("reply_id",0),o.set("to",this.commentTo),this.$req.post("sendOneComment",o).then((function(e){if(void 0==e.errno){t.comments.push(e.comment);var o=t.choose_post.reply_count+1;t.$set(t.choose_post,"reply_count",o),t.text="",t.commentTo="",t.$notify("success","发送成功")}}))}}else this.$notify("error","未登陆")},showNewSolutionModal:function(){this.newSolutionModal=!0},submit:function(){var t=this;if(this.$store.state.user.is_login)if(""!=this.value.trim()){var e=new FormData;e.set("kind","solution"),e.set("problem",this.index),e.set("content",this.value),e.set("html_content",this.$refs.editor.d_render),e.set("tags",JSON.stringify(this.$refs.tags.get_select_tags())),this.$req.post("newPost",e).then((function(e){void 0==e.errno&&(t.$notify("success","提交成功"),t.value="",t.newSolutionModal=!1,t.current=1,t.get_solutions())}))}else this.$notify("error","请输入内容");else this.$notify("error","请先登陆")},get_solutions:function(){var t=this,e=this.page_size*(this.current-1)+1,o=e+this.page_size-1;this.$req.get("getPostList",{kind:"solution",l:e,r:o,index:this.index}).then((function(e){if(void 0==e.errno){t.solution_list=e.data,t.total=e.total;var o,s=i(t.solution_list);try{for(s.s();!(o=s.n()).done;){var a=o.value;""!=a.tags?a.tags=JSON.parse(a.tags):a.tags=[],1==a.for_post?a.good_color="blue":2==a.for_post&&(a.bad_color="blue")}}catch(n){s.e(n)}finally{s.f()}t.loaded=!0}}))},imgAdd:function(t,e){var o=this,s=new FormData;s.set("file",e),this.$req.post("addImg",s).then((function(e){o.$refs.editor.$img2Url(t,e.url)}))}},mounted:function(){var t=this;this.index=this.$route.params.index,this.title=this.$route.query.title,void 0==this.index?this.$router.push({name:"home"}):setTimeout((function(){t.get_solutions(),void 0==t.title&&t.$req.get("getProblemTitle",{index:t.index}).then((function(e){void 0==e.errno&&(t.title=e.title)}))}),300)}},d=c,u=o("2877"),m=o("f09f"),_=o("068f"),p=o("eb85"),f=o("66e5"),h=o("4074"),v=o("cb32"),g=o("0170"),b=o("9c40"),y=o("0016"),x=o("4983"),q=o("d66b"),w=o("eebe"),C=o.n(w),S=Object(u["a"])(d,s,a,!1,null,"eef61aee",null);e["default"]=S.exports;C()(S,"components",{QCard:m["a"],QImg:_["a"],QSeparator:p["a"],QItem:f["a"],QItemSection:h["a"],QAvatar:v["a"],QItemLabel:g["a"],QBtn:b["a"],QIcon:y["a"],QScrollArea:x["a"],QEditor:q["a"]})}}]);