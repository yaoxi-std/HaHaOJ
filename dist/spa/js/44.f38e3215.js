(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([[44],{df79:function(t,e,s){"use strict";s.r(e);var a=function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",{staticClass:"q-pa-lg"},[s("div",{staticClass:"text-black"},[s("div",{staticClass:"text-h6"},[t._v("文章类型:")]),s("div",{staticClass:"q-gutter-lg",staticStyle:{"font-size":"16px"}},[s("q-radio",{attrs:{val:"blog",label:"博客",color:"teal","keep-color":""},model:{value:t.kind,callback:function(e){t.kind=e},expression:"kind"}}),s("q-radio",{attrs:{val:"puzzle",label:"求助(讨论)",color:"orange","keep-color":""},model:{value:t.kind,callback:function(e){t.kind=e},expression:"kind"}}),s("q-radio",{attrs:{val:"solution",label:"题解",color:"red","keep-color":""},model:{value:t.kind,callback:function(e){t.kind=e},expression:"kind"}})],1)]),s("q-separator"),s("q-form",{staticClass:"text-black q-mt-md text-h6",on:{submit:t.submit}},["solution"!=t.kind?s("div",{staticClass:"q-gutter-md row items-start"},[s("div",[t._v("标 题")]),s("q-input",{staticStyle:{width:"500px"},attrs:{dense:"",outlined:"","lazy-rules":"",rules:[function(t){return t&&t.length>0||"请输入标题"},function(t){return t.length<=40||"标题太长"}]},model:{value:t.head,callback:function(e){t.head=e},expression:"head"}})],1):t._e(),"blog"!=t.kind?s("div",{staticClass:"row items-start q-gutter-md q-mt-md"},[s("div",[t._v("题 目")]),s("q-input",{staticStyle:{width:"200px"},attrs:{dense:"",outlined:"","lazy-rules":"",rules:[function(e){return"puzzle"==t.kind||e.length>0||"请输入题目"}]},model:{value:t.problem,callback:function(e){t.problem=e},expression:"problem"}}),"puzzle"==t.kind?s("div",{staticClass:"text-blue"},[t._v("(可以不设置，如果设置了相关题目，该帖子会放到对应题目的讨论栏，不会出现公共系统的讨论栏中)")]):t._e()],1):t._e(),s("div",{staticClass:"q-gutter-sm row items-start q-mt-md"},[s("div",[t._v("公 开")]),s("q-toggle",{attrs:{color:"primary"},model:{value:t.is_open,callback:function(e){t.is_open=e},expression:"is_open"}}),s("div",{staticClass:"text-blue"},[t._v("(未编写完成时，推荐不公开)")])],1),s("div",{staticClass:"q-gutter-sm row items-start q-mt-md"},[s("div",[t._v("允许评论")]),s("q-toggle",{attrs:{color:"primary"},model:{value:t.can_reply,callback:function(e){t.can_reply=e},expression:"can_reply"}})],1),s("div",{staticClass:"q-mt-md"},[s("Tags",{ref:"tags",attrs:{prop_tags:t.prop_tags}})],1),s("q-separator",{staticClass:"q-mt-md"}),s("div",{staticClass:"q-mt-md"},[s("mavon-editor",{ref:"editor",on:{imgAdd:t.imgAdd,imgDel:t.imgDel},model:{value:t.value,callback:function(e){t.value=e},expression:"value"}})],1),s("q-btn",{staticClass:"q-mt-md",attrs:{type:"submit",color:"primary",label:"提 交"}})],1)],1)},i=[],l=s("3855"),o={name:"NewPost",components:{Tags:l["a"]},data:function(){return{value:"",kind:"blog",head:"",can_reply:!0,is_open:!0,problem:"",prop_tags:[]}},methods:{get_html:function(){return this.$refs.editor.d_render},get_text:function(){return value},getForm:function(){var t=new FormData;return t.set("kind",this.kind),t.set("is_open",this.is_open),t.set("can_reply",this.can_reply),"blog"!=this.kind&&(this.problem=this.problem.trim(),""!=this.problem&&t.set("problem",this.problem)),t.set("content",this.value),t.set("html_content",this.get_html()),"solution"!=this.kind&&t.set("head",this.head),t.set("tags",JSON.stringify(this.$refs.tags.get_select_tags())),t},submit:function(){var t=this;this.$req.post("newPost",this.getForm()).then((function(e){void 0==e.errno&&(t.$notify("success","提交成功"),t.$router.push({name:"onePost",params:{post_id:e.post_id}}))}))},imgAdd:function(t,e){var s=this,a=new FormData;a.set("file",e),this.$req.post("addImg",a).then((function(e){s.$refs.editor.$img2Url(t,e.url)}))}}},n=o,r=s("2877"),d=s("3786"),c=s("eb85"),u=s("0378"),m=s("27f9"),p=s("9564"),v=s("9c40"),g=s("eebe"),h=s.n(g),b=Object(r["a"])(n,a,i,!1,null,"084de531",null);e["default"]=b.exports;h()(b,"components",{QRadio:d["a"],QSeparator:c["a"],QForm:u["a"],QInput:m["a"],QToggle:p["a"],QBtn:v["a"]})}}]);